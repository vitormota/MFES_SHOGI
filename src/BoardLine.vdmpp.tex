\kClass $BoardLine$
\par
\kTypes
\type{\kw{public}\hspace{0.5em}Player}{\const{White} \TypeOr \const{Black};}
\type{\kw{public}\hspace{0.5em}Line}{\mapof{\Natone \Gmap Cell}}
\begin{invfn}{l} \Card \pex{ \Dom \pex{l}} \Equals 9 \And  \Dom \pex{l} \Equals \setrange{1}{9}
\end{invfn}
\kInstanceVarDef
\parlinebr
\begin{insvar}\kw{private}
\assdef{line}{Line}
\end{insvar}
\begin{insvar}\kw{private}
\assdef{y}{\Natone }
\end{insvar}
\begin{instinvfn}
y \In \setrange{1}{9}\end{instinvfn}
\par
\kOperations
\kw{\kw{public}}\begin{op}[e]{BoardLine}%
\signature{\seqof*{Cell} \Mult \Natone  \Oto BoardLine}
\parms{cells,yi}
\annlab[o]{BoardLine`BoardLine}
\begin{blockstmt}
\ass{y}{yi} ; \\
\ass{line}{\mapcomp{x \Mapsto cell}{x \In \setrange{1}{9},cell \In  \Elems \pex{cells}} \\
[cell.x \Equals x]}
\end{blockstmt}
\begin{precond}
 \Len cells \Equals 9
\end{precond}
\begin{postcond}
\all{cell \In  \Elems \pex{cells}}{cell.y \Equals yi \And yi \Equals y}
\end{postcond};
\end{op}
\kw{\kw{public}}\begin{op}[e]{getCell}%
\signature{\Natone  \Oto Cell}
\parms{r}
\annlab[o]{BoardLine`getCell}
\return{\fnapply{line}{r}}
\begin{precond}
r \In  \Dom \pex{line}
\end{precond}
\begin{postcond}
line \Equals \old{line}
\end{postcond};
\end{op}
\kw{\kw{public}}\begin{op}[e]{getCells}%
\signature{Player \Oto \setof{Cell}}
\parms{p}
\annlab[o]{BoardLine`getCells}
\return{\setcomp{c}{c \In  \Rng line}[c.piece \Neq \Nil  \And c.piece.belongTo \Equals p]};
\end{op}
\kw{\kw{public}}\begin{op}[e]{getEmptyCells}%
\signature{() \Oto \setof{Cell}}
\parms{}
\annlab[o]{BoardLine`getEmptyCells}
\return{\setcomp{c}{c \In  \Rng line}[c.piece \Equals \Nil ]};
\end{op}
\kw{\kw{public}}\begin{op}[e]{getSeqCells}%
\signature{() \Oto \seqof*{Cell}}
\parms{}
\annlab[o]{BoardLine`getSeqCells}
\return{\fnapply{getSeqCellsAux}{1}};
\end{op}
\kw{\kw{private}}\begin{op}[e]{getSeqCellsAux}%
\signature{\Natone  \Oto \seqof*{Cell}}
\parms{x}
\annlab[o]{BoardLine`getSeqCellsAux}
\begin{blockstmt}
\If x \Equals 9
\Then \\
\return{\seq{\fnapply{line}{x}}}
\Else \\
\return{\seq{\fnapply{line}{x}} \Sconc \fnapply{getSeqCellsAux}{x \Plus 1}}
\Fi
\end{blockstmt}
\begin{precond}
x \In \setrange{1}{9}
\end{precond}
\end{op}
\kEnd $BoardLine$

